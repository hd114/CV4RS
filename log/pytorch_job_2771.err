/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:03<00:00,  3.79s/it]training: 100%|██████████| 1/1 [00:03<00:00,  3.92s/it]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  2.06it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.52it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  2.18it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.59it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  2.03it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.49it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.98it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.44it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.67it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.29it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.85it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.37it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.83it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.36it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.88it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.40it/s]
test:   0%|          | 0/1 [00:00<?, ?it/s]test: 100%|██████████| 1/1 [00:00<00:00,  5.91it/s]test: 100%|██████████| 1/1 [00:00<00:00,  5.90it/s]
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:1030: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  warnings.warn(
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.89it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.34it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.95it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.43it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.87it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.39it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.83it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.36it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.91it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.39it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.95it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.42it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.93it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.34it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.98it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.44it/s]
training:   0%|          | 0/1 [00:00<?, ?it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.77it/s]training: 100%|██████████| 1/1 [00:00<00:00,  1.33it/s]
test:   0%|          | 0/1 [00:00<?, ?it/s]test: 100%|██████████| 1/1 [00:00<00:00,  5.73it/s]test: 100%|██████████| 1/1 [00:00<00:00,  5.71it/s]
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Traceback (most recent call last):
  File "/home/paul/projects/CV4RS-orig/train.py", line 35, in <module>
    train()
  File "/home/paul/projects/CV4RS-orig/train.py", line 30, in train
    global_model, global_results = global_client.train(communication_rounds=communication_rounds, epochs=epochs)
  File "/home/paul/projects/CV4RS-orig/utils/clients.py", line 668, in train
    report = self.validation_round()
  File "/home/paul/projects/CV4RS-orig/utils/clients.py", line 715, in validation_round
    report = get_classification_report(
  File "/home/paul/projects/CV4RS-orig/utils/pytorch_utils.py", line 81, in get_classification_report
    ap_mic = average_precision_score(y_true, predicted_probs, average="micro")
  File "/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 268, in average_precision_score
    return _average_binary_score(
  File "/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/metrics/_base.py", line 80, in _average_binary_score
    y_score = check_array(y_score)
  File "/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/utils/validation.py", line 1064, in check_array
    _assert_all_finite(
  File "/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/utils/validation.py", line 123, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "/faststorage/paul/mamba/envs/pytorch_env/lib/python3.10/site-packages/sklearn/utils/validation.py", line 172, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input contains NaN.
